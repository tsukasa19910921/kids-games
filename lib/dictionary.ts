/**
 * Dictionary for Shiritori game
 * しりとりゲーム用辞書
 */

import { normalizeKana } from './utils'

/**
 * Dictionary of Japanese words (hiragana)
 * 日本語単語辞書（ひらがな）
 */
export const DICTIONARY: string[] = [
  // あ行
  'あさがお', 'あめ', 'あり', 'あひる', 'あざらし', 'あいす', 'あか', 'あお', 'あき', 'あさ',
  'いぬ', 'いるか', 'いちご', 'いす', 'いえ', 'いし', 'いと', 'いろ', 'いけ', 'いも',
  'うさぎ', 'うみ', 'うし', 'うま', 'うめ', 'うで', 'うた', 'うち', 'うえ', 'うお',
  'えび', 'えんぴつ', 'えほん', 'えき', 'えいが', 'えだ', 'えり', 'えん', 'えさ', 'えのぐ',
  'おにぎり', 'おれんじ', 'おに', 'おと', 'おや', 'おみせ', 'おかし', 'おふろ', 'おさら', 'おとこ',

  // か行
  'かえる', 'かめ', 'かに', 'かさ', 'かみ', 'かお', 'かぜ', 'かた', 'かど', 'かき',
  'きりん', 'きつね', 'きのこ', 'きく', 'きって', 'きもの', 'きた', 'きいろ', 'きぬ', 'きのう',
  'くま', 'くるま', 'くつ', 'くち', 'くも', 'くび', 'くし', 'くに', 'くすり', 'くぎ',
  'けーき', 'けむし', 'けしごむ', 'けいと', 'けが', 'けむり', 'けいさつ', 'けん', 'けた', 'けいば',
  'こあら', 'ごりら', 'こおり', 'こま', 'こめ', 'こえ', 'ごはん', 'こころ', 'こうえん', 'こども',

  // さ行
  'さる', 'さかな', 'さくら', 'さとう', 'さいふ', 'さら', 'さむらい', 'さけ', 'さんま', 'さか',
  'しまうま', 'しか', 'しお', 'しま', 'しろ', 'した', 'しんごう', 'しんぶん', 'しごと', 'しゃしん',
  'すいか', 'すずめ', 'すし', 'すな', 'すみ', 'すいとう', 'すべりだい', 'すもも', 'すず', 'すいみん',
  'せみ', 'せんべい', 'せんせい', 'せなか', 'せかい', 'せっけん', 'せん', 'せつめい', 'せいと', 'せんたく',
  'そら', 'そば', 'そで', 'その', 'そと', 'そふ', 'そぼ', 'そり', 'そうじ', 'そこ',

  // た行
  'たこ', 'たぬき', 'たまご', 'たいこ', 'たいよう', 'たけ', 'たね', 'たび', 'たな', 'たから',
  'ちょうちょ', 'ちず', 'ちから', 'ちち', 'ちかてつ', 'ちきゅう', 'ちゃわん', 'ちゅうしゃ', 'ちゃいろ', 'ちかく',
  'つき', 'つる', 'つくえ', 'つめ', 'つち', 'つな', 'つゆ', 'つばさ', 'つぼ', 'つえ',
  'てれび', 'てがみ', 'てんき', 'てんぷら', 'てぶくろ', 'てつ', 'てんとうむし', 'てら', 'てんじょう', 'てんいん',
  'とけい', 'とら', 'とんぼ', 'とり', 'とまと', 'とうふ', 'ともだち', 'とびら', 'とんかつ', 'とうもろこし',

  // な行
  'なす', 'なし', 'なみ', 'なまえ', 'なつ', 'なべ', 'なか', 'ながぐつ', 'ななつ', 'なみだ',
  'にじ', 'にんじん', 'にわとり', 'にわ', 'にく', 'にもつ', 'にっき', 'にほん', 'にし', 'にんぎょう',
  'ぬいぐるみ', 'ぬま', 'ぬの', 'ぬりえ', 'ぬげ', 'ぬくもり',
  'ねこ', 'ねずみ', 'ねぎ', 'ねっこ', 'ねつ', 'ねまき', 'ねんど', 'ねんれい',
  'のり', 'のこぎり', 'のど', 'のうみそ', 'のぼり', 'のみもの',

  // は行
  'はと', 'はな', 'はし', 'はこ', 'はち', 'はる', 'はた', 'はさみ', 'はね', 'はんかち',
  'ひまわり', 'ひつじ', 'ひも', 'ひげ', 'ひざ', 'ひだり', 'ひかり', 'ひる', 'ひと', 'ひよこ',
  'ふね', 'ふとん', 'ふゆ', 'ふく', 'ふうせん', 'ふくろ', 'ふで', 'ふた', 'ふえ', 'ふみきり',
  'へび', 'へや', 'へそ', 'へいわ', 'へた', 'へり',
  'ぺんぎん', 'ぺん', 'ぺっと', 'ぺーじ',
  'ほし', 'ほん', 'ほね', 'ほっぺ', 'ほうき', 'ほたる', 'ほうれんそう', 'ほけん', 'ほうそく', 'ほうがく',

  // ま行
  'まんと', 'まくら', 'まど', 'まゆげ', 'まつり', 'まち', 'まめ', 'まいにち', 'まご', 'まほう',
  'みかん', 'みみ', 'みず', 'みち', 'みせ', 'みどり', 'みそ', 'みなみ', 'みそしる', 'みんな',
  'むし', 'むぎ', 'むね', 'むすこ', 'むすめ', 'むら', 'むかし', 'むぎわら',
  'めがね', 'めだか', 'めん', 'めし', 'めいれい', 'めんどう',
  'もも', 'もち', 'もり', 'もぐら', 'もの', 'もんだい', 'もくよう', 'もよう',

  // や行
  'やま', 'やぎ', 'やね', 'やさい', 'やきゅう', 'やかん', 'やど', 'やくそく', 'やすみ', 'やおや',
  'ゆき', 'ゆめ', 'ゆび', 'ゆか', 'ゆうひ', 'ゆうがた', 'ゆうびんきょく', 'ゆうれい', 'ゆず', 'ゆたんぽ',
  'ようふく', 'よる', 'よん', 'よこ', 'よわむし',

  // ら行
  'らいおん', 'らっぱ', 'らっこ', 'らくだ', 'らーめん',
  'りんご', 'りす', 'りょうり', 'りょこう', 'りゆう', 'りんご', 'りぼん', 'りくつ', 'りょうほう', 'りょうきん',
  'るーる', 'るすばん',
  'れもん', 'れいぞうこ', 'れんしゅう', 'れんらく', 'れきし', 'れっしゃ',
  'ろけっと', 'ろうそく', 'ろうか', 'ろば', 'ろんぶん',

  // わ行
  'わに', 'わたあめ', 'わかめ', 'わし', 'わた', 'わなげ', 'わかもの', 'わんこ',

  // 追加の単語
  'かばん', 'がっこう', 'きって', 'ぎゅうにゅう', 'くつした', 'げんかん', 'こうちゃ', 'ごみ',
  'さんかく', 'しかく', 'すうじ', 'ぜりー', 'そうじき', 'たいいく', 'だいどころ', 'ちゃいろ',
  'つくし', 'でんき', 'でんしゃ', 'とうきょう', 'どんぐり', 'なまえ', 'にんげん', 'ねっとう',
  'のうか', 'ばなな', 'ぱんだ', 'ぴあの', 'ぷーる', 'べんとう', 'ぼうし', 'ぽけっと',
  'まつぼっくり', 'みかづき', 'むぎちゃ', 'めがみ', 'もくば', 'やきいも', 'ゆうえんち',
  'よぞら', 'らくご', 'りょうしん', 'れすとらん', 'ろうどく', 'わかば',

  // 動物追加
  'いのしし', 'おおかみ', 'かぶとむし', 'きじ', 'くじゃく', 'くわがた', 'こうもり', 'さい',
  'しまりす', 'ぞう', 'だちょう', 'とかげ', 'なまけもの', 'ぱんだ', 'ひょう', 'ふくろう',
  'へらじか', 'まんぼう', 'もぐら', 'やまどり', 'らくだ', 'わし', 'ぞうりむし',

  // 食べ物追加
  'あんぱん', 'うどん', 'おでん', 'かれー', 'ぎょうざ', 'くっきー', 'こんぶ', 'さんま',
  'しゃけ', 'すーぷ', 'そーだ', 'たいやき', 'ちーず', 'てんどん', 'どーなつ', 'なっとう',
  'ぱん', 'ぴざ', 'ぷりん', 'ほっとけーき', 'まかろに', 'めろん', 'やきそば', 'よーぐると',
  'らーゆ', 'りんごじゅーす', 'わかめ', 'おにぎり', 'かりんとう', 'くるみ', 'こんにゃく',

  // 物・道具追加
  'あみ', 'いと', 'えんぴつけずり', 'おもちゃ', 'かがみ', 'きっぷ', 'くぎ', 'けいたい',
  'こっぷ', 'さいころ', 'しゃべる', 'すぷーん', 'そーす', 'たおる', 'ちょーく', 'つみき',
  'てーぷ', 'どあ', 'なわ', 'ぱれっと', 'ふでばこ', 'ぺんち', 'ほうちょう', 'まくら',
  'みらー', 'めもちょう', 'もっぷ', 'やかん', 'ゆびわ', 'らじお', 'りもこん', 'れじ',
  'ろっかー', 'わごむ',

  // 自然・天気
  'あめ', 'いなずま', 'うみ', 'おがわ', 'かぜ', 'きり', 'くも', 'けしき', 'こおり',
  'さばく', 'しも', 'すなはま', 'たいふう', 'つなみ', 'にじ', 'はれ', 'ふぶき', 'みずうみ',
  'やま', 'ゆき', 'らいう', 'わだち',

  // 体の部分
  'あし', 'あたま', 'うで', 'おなか', 'かお', 'かた', 'くち', 'くび', 'こし', 'せなか',
  'て', 'みみ', 'め', 'ゆび', 'は',

  // 色
  'あか', 'あお', 'きいろ', 'みどり', 'しろ', 'くろ', 'ちゃいろ', 'むらさき', 'もも', 'おれんじ',

  // その他
  'えいご', 'おんがく', 'かいもの', 'きゅうしょく', 'げーむ', 'こうさく', 'さんすう', 'しゅくだい',
  'すぽーつ', 'たんじょうび', 'てすと', 'なつやすみ', 'はなび', 'ぷれぜんと', 'ほーむわーく',
  'まんが', 'ゆめ', 'らんどせる', 'わくせい'
]

/**
 * Find words that start with the specified character
 * 指定された文字で始まる単語を検索
 */
export function findWords(startChar: string, usedWords: string[] = []): string[] {
  const normalizedChar = normalizeKana(startChar)
  const normalizedUsed = usedWords.map(w => normalizeKana(w))

  return DICTIONARY.filter(word => {
    const normalized = normalizeKana(word)
    return (
      normalized.startsWith(normalizedChar) &&
      !normalizedUsed.includes(normalized) &&
      !normalized.endsWith('ん')
    )
  })
}

/**
 * Get a random word from the array
 * 配列からランダムに単語を取得
 */
export function getRandomWord(words: string[]): string | null {
  if (words.length === 0) return null
  const randomIndex = Math.floor(Math.random() * words.length)
  return words[randomIndex]
}

/**
 * Check if a word exists in the dictionary
 * 単語が辞書に存在するかチェック
 */
export function isValidWord(word: string): boolean {
  const normalized = normalizeKana(word)
  return DICTIONARY.some(dictWord => normalizeKana(dictWord) === normalized)
}

/**
 * Get dictionary statistics
 * 辞書の統計情報を取得
 */
export function getDictionaryStats() {
  return {
    totalWords: DICTIONARY.length,
    uniqueWords: new Set(DICTIONARY.map(w => normalizeKana(w))).size
  }
}
